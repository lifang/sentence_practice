<script>
  var access_token = window.location.hash.substring(1);;
  alert(access_token);
	var path = "https://graph.qq.com/oauth2.0/me?";
  var queryParams = [access_token, 'callback=callback'];
  var query = queryParams.join('&');
  var url = path + query;
  var script = document.createElement('script');
  script.src = url;
  document.body.appendChild(script);
  function callback(user){
    $.ajax({
      async:true,
      type: "POST",
      url: "/logins/enter.json",
      dataType: "json",
      data : {
        open_id :user.openid,
        access_token:access_token
      },
      success: function(data){
          alert(data);
          alert(window.opener.location.href);
        if(data){
          //(window.opener.location.href.split('?last_url=')[1]==null) ? window.opener.location.reload() : window.opener.location.href = window.opener.location.href.split('?last_url=')[1] ;window.close();
          //(window.opener.location.href.split('/logins/')[1]==null) ? window.opener.location.reload() : window.opener.location.href = window.opener.location.href;window.close();
          //document.close();
          document.location.href='http://test.sunworldmedia.com';
          //window.close();
        }else{
          window.opener.location.reload();
          window.close();
        }
      }
    });
  }
</script>